<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pasta League âš½</title>
  <style>
    body {
      background: #0b0b0b;
      color: white;
      font-family: "Poppins", sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      font-size: 2.5em;
      color: #ffd700;
      margin-top: 20px;
    }
    table {
      width: 90%;
      margin: 20px auto;
      border-collapse: collapse;
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid rgba(255,255,255,0.2);
      padding: 10px;
      font-size: 1.1em;
    }
    th {
      background: #222;
    }
    .first-place {
      background: linear-gradient(90deg, gold, #ffef9f);
      color: black;
      font-weight: bold;
    }
    .second-place {
      background: linear-gradient(90deg, silver, #dddddd);
      color: black;
      font-weight: bold;
    }
    .playoff {
      background: linear-gradient(90deg, #007bff, #00c3ff);
      color: white;
      font-weight: bold;
    }
    .top-scorers {
      width: 60%;
      margin: 40px auto;
    }
    .fixture {
      background: rgba(255,255,255,0.08);
      margin: 6px auto;
      padding: 8px;
      border-radius: 6px;
      width: 80%;
      border: 1px solid #555;
    }
    .draw-button {
      background: #ffd700;
      color: black;
      border: none;
      padding: 10px 25px;
      font-weight: bold;
      border-radius: 10px;
      margin-top: 20px;
    }
    .draw-button:hover { cursor:pointer; opacity:0.9; }
    #draw-date {
      margin-top: 10px;
      color: #ccc;
    }
    .player-gallery {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 40px;
    }
    .player-card {
      width: 120px;
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
      padding: 10px;
    }
    .player-card img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 10px;
    }
    .player-card h3 {
      margin: 8px 0 0;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <h1>ğŸ† Pasta League ğŸ†</h1>

  <!-- League Table -->
  <table id="leagueTable">
    <tr><th>Pos</th><th>Player</th><th>Points</th></tr>
    <tr class="first-place"><td>1</td><td>Alex</td><td>25</td></tr>
    <tr class="second-place"><td>2</td><td>Tibi</td><td>22</td></tr>
    <tr class="playoff"><td>3</td><td>Liad</td><td>19</td></tr>
    <tr class="playoff"><td>4</td><td>Aviv</td><td>18</td></tr>
    <tr class="playoff"><td>5</td><td>Elior</td><td>16</td></tr>
    <tr class="playoff"><td>6</td><td>Yarden</td><td>14</td></tr>
    <tr><td>7</td><td>Artur</td><td>13</td></tr>
    <tr><td>8</td><td>Gil</td><td>11</td></tr>
    <tr><td>9</td><td>Ilya</td><td>10</td></tr>
    <tr><td>10</td><td>Shabo</td><td>8</td></tr>
  </table>

  <!-- Top Scorers -->
  <h2>âš½ Top Scorers</h2>
  <table class="top-scorers">
    <tr><th>Rank</th><th>Player</th><th>Goals</th></tr>
    <tr><td>1</td><td>Alex</td><td>9</td></tr>
    <tr><td>2</td><td>Tibi</td><td>8</td></tr>
    <tr><td>3</td><td>Liad</td><td>7</td></tr>
    <tr><td>4</td><td>Aviv</td><td>6</td></tr>
    <tr><td>5</td><td>Gil</td><td>5</td></tr>
  </table>

  <!-- Fixtures -->
  <section id="fixtures">
    <h2>Next Matchday Fixtures âš½</h2>
    <div id="fixtures-container"></div>
    <button id="draw-button" class="draw-button">Draw New Fixtures</button>
    <p id="draw-date"></p>
  </section>

  <!-- Player Gallery -->
  <h2>ğŸ“¸ Players</h2>
  <div class="player-gallery">
    <div class="player-card"><img src="https://i.imgur.com/ErD3KcB.jpeg"><h3>Alex</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/ZX7Yhdq.jpeg"><h3>Tibi</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/0Q3JYwB.jpeg"><h3>Liad</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/ExrMLq8.jpeg"><h3>Aviv</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/OpYud80.jpeg"><h3>Elior</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/TPLvPBo.jpeg"><h3>Yarden</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/6Z3GrVr.jpeg"><h3>Artur</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/nQzKWhF.jpeg"><h3>Gil</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/jR2T6j2.jpeg"><h3>Ilya</h3></div>
    <div class="player-card"><img src="https://i.imgur.com/cE5yEt4.jpeg"><h3>Shabo</h3></div>
  </div>

  <script>
    const sheetId = "1-0WXbluyvAOphZzuoXJ0yYqBQmJXoTOrdWny8KURwdI";
    const fixturesSheet = "PastaLeague_Fixtures";
    const password = "1122";
    const drawButton = document.getElementById("draw-button");
    const fixturesContainer = document.getElementById("fixtures-container");
    const drawDateElement = document.getElementById("draw-date");

    async function loadFixtures() {
      try {
        const response = await fetch(
          `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${fixturesSheet}`
        );
        const text = await response.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;
        if (rows.length === 0) {
          fixturesContainer.innerHTML = "<p>No fixtures yet ğŸ”„</p>";
          return;
        }
        fixturesContainer.innerHTML = "";
        rows.forEach(row => {
          const match = document.createElement("div");
          match.classList.add("fixture");
          match.textContent = `${row.c[0].v} ğŸ†š ${row.c[1].v}`;
          fixturesContainer.appendChild(match);
        });
        const lastDraw = rows[0].c[2]?.v;
        if (lastDraw) drawDateElement.textContent = `Last Draw: ${lastDraw}`;
      } catch {
        fixturesContainer.innerHTML = "<p>âš ï¸ Can't load fixtures right now</p>";
      }
    }

    async function drawFixtures() {
      const pass = prompt("Enter password:");
      if (pass !== password) return alert("âŒ Wrong password!");

      const players = ["Shabo","Ilya","Liad","Aviv","Elior","Yarden","Artur","Gil","Alex","Tibi"];
      const shuffled = players.sort(() => Math.random() - 0.5);
      const fixtures = [];
      for (let i=0;i<shuffled.length;i+=2){
        fixtures.push([shuffled[i],shuffled[i+1]]);
      }

      const today = new Date().toLocaleString("en-GB");
      fixturesContainer.innerHTML = "";
      fixtures.forEach(pair => {
        const match = document.createElement("div");
        match.classList.add("fixture");
        match.textContent = `${pair[0]} ğŸ†š ${pair[1]}`;
        fixturesContainer.appendChild(match);
      });
      drawDateElement.textContent = `Last Draw: ${today}`;

      // ×©××™×¨×” ×‘×’×™×œ×™×•×Ÿ ×“×¨×š "Form Response"
      const url = `https://script.google.com/macros/s/AKfycbz-your-script-id/exec`; 
      const data = new URLSearchParams();
      data.append("matches", JSON.stringify(fixtures));
      data.append("date", today);
      await fetch(url, { method: "POST", body: data });
    }

    drawButton.addEventListener("click", drawFixtures);
    loadFixtures();
  </script>
</body>
</html>
