<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pasta League ‚Äî Season 2025</title>
  <style>
    :root {
      --gold: #ffd84d;
      --bg: #000;
      --panel: #0d0d0d;
      --line: #ffcf3a;
      --teal: #27e6ff;
      --pink: #ff4da6;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: #fff;
      font-family: "Inter", system-ui, sans-serif;
      text-align: center;
    }
    .wrap { max-width: 1024px; margin: 0 auto; padding: 14px; }
    .glow { color: var(--gold); text-shadow: 0 0 22px var(--gold); }
    h1 { font-size: 42px; margin: 16px 0 6px; }

    .panel {
      background: linear-gradient(180deg, #0b0b0b, #151515);
      border: 2px solid var(--line);
      border-radius: 18px;
      padding: 16px;
      margin: 16px 0;
      box-shadow: 0 0 34px rgba(255, 216, 77, 0.25);
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      overflow: hidden;
      border-radius: 14px;
    }
    th {
      background: linear-gradient(180deg, #ffd84d, #ffb800);
      color: #000;
      font-weight: 800;
      padding: 10px;
    }
    td {
      padding: 10px;
      background: #0e0e0e;
      border-bottom: 1px solid rgba(255, 216, 77, 0.25);
    }

    .rank { font-weight: 800; }
    .player { font-weight: 700; }

    /* ◊¶◊ë◊¢◊ô◊ù ◊ú◊§◊ô ◊û◊ß◊ï◊û◊ï◊™ */
    .top2 td { background: #fff; color: #000; }
    .playoff td { background: var(--pink); color: #000; }
    .mid td { background: #0e0e0e; }

    .arrow {
      display: inline-block;
      border-left: 7px solid transparent;
      border-right: 7px solid transparent;
      border-bottom: 12px solid #0a0;
      margin-left: 6px;
    }

    .splash {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;
      z-index: 9999;
      animation: fadeOut 2s 0.4s forwards;
    }
    .splash img {
      width: 150px;
      filter: drop-shadow(0 0 25px var(--gold));
    }
    @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }

    .title-2 {
      font-size: 36px;
      margin: 8px 0 14px;
      color: #7bf3ff;
      text-shadow: 0 0 22px #27e6ff;
    }

    .updated { opacity: 0.8; font-size: 14px; margin-top: 6px; }
    .btn {
      background: var(--gold);
      color: #000;
      font-weight: 800;
      padding: 10px 14px;
      border-radius: 10px;
      text-decoration: none;
      margin-top: 10px;
      display: inline-block;
    }

    .status {
      margin-top: 20px;
      font-weight: 600;
    }
    .ok { color: #00ff7f; }
    .fail { color: #ff4040; }
  </style>
</head>
<body>
  <!-- ◊ú◊ï◊í◊ï ◊§◊™◊ô◊ó◊î ◊ú◊©◊™◊ô ◊©◊†◊ô◊ï◊™ -->
  <div class="splash"><img src="pasta-logo.png" alt="Pasta Logo"></div>

  <div class="wrap">
    <h1 class="glow">Pasta League ‚Äî Season 2025</h1>

    <div class="panel">
      <h2 class="glow">League Table</h2>
      <div class="updated" id="updatedAt">Last updated: ‚Äî</div>
      <div id="leagueTableContainer"></div>
    </div>

    <div class="panel">
      <h2 class="title-2">Top Scorers ‚öΩ</h2>
      <div id="scorersContainer"></div>
    </div>

    <a class="btn" href="players.html">üì∏ Players list</a>

    <div class="status" id="statusText">Connecting to Google Sheets...</div>
  </div>

  <script>
    const SHEET_ID = "1--or-XBf1Ys71it7cRCSnZOodHIP8wr9bW_HUoTJtCs"; // ◊©◊ú◊ö
    const TAB_LEAGUE = "LeagueTable";
    const TAB_SCORERS = "Scorers";

    const cb = () => `&_=${Date.now()}`;

    async function fetchSheet(tabName) {
      const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(tabName)}${cb()}`;
      const res = await fetch(url);
      const text = await res.text();
      const json = JSON.parse(text.replace(/^.*setResponse\(/, "").replace(/\);\s*$/, ""));
      return json.table.rows.map(r => (r.c || []).map(c => (c ? c.v : "")));
    }

    function renderLeague(rows) {
      const data = rows.slice(1).filter(r => r[0]);
      let html = `
        <table>
          <thead><tr>
            <th>RANK</th><th>PLAYER</th><th>W</th><th>D</th><th>L</th><th>GF</th><th>GA</th><th>PTS</th>
          </tr></thead><tbody>
      `;
      data.forEach((r, i) => {
        const rank = i + 1;
        let cls = "mid";
        if (rank <= 2) cls = "top2";
        else if (rank <= 6) cls = "playoff";
        let medal = "";
        if (rank === 1) medal = " üèÜ<span class='arrow'></span>";
        if (rank === 2) medal = " ü•à<span class='arrow'></span>";
        html += `<tr class="${cls}">
          <td>${rank}</td>
          <td>${r[0]}${medal}</td>
          <td>${r[1]}</td><td>${r[2]}</td><td>${r[3]}</td><td>${r[4]}</td><td>${r[5]}</td><td>${r[6]}</td>
        </tr>`;
      });
      html += "</tbody></table>";
      document.getElementById("leagueTableContainer").innerHTML = html;
    }

    function renderScorers(rows) {
      const data = rows.slice(1).filter(r => r[0]);
      let html = `
        <table>
          <thead><tr><th>Rank</th><th>Player</th><th>Goals</th></tr></thead>
          <tbody>
      `;
      data.forEach((r, i) => {
        html += `<tr>
          <td>${i + 1}</td><td>${r[0]}${i === 0 ? " ‚öΩ" : ""}</td><td>${r[1]}</td>
        </tr>`;
      });
      html += "</tbody></table>";
      document.getElementById("scorersContainer").innerHTML = html;
    }

    function updateTime() {
      const d = new Date();
      const p = n => String(n).padStart(2, "0");
      document.getElementById("updatedAt").textContent =
        `Last updated: ${p(d.getDate())}.${p(d.getMonth() + 1)}.${d.getFullYear()}, ${p(d.getHours())}:${p(d.getMinutes())}:${p(d.getSeconds())}`;
    }

    async function init() {
      try {
        const [league, scorers] = await Promise.all([
          fetchSheet(TAB_LEAGUE),
          fetchSheet(TAB_SCORERS)
        ]);
        renderLeague(league);
        renderScorers(scorers);
        updateTime();
        document.getElementById("statusText").innerHTML = "‚úÖ Connected to Google Sheets";
        document.getElementById("statusText").className = "status ok";
      } catch (err) {
        document.getElementById("leagueTableContainer").innerHTML =
          `<div style="color:#f66">‚ö† Error loading Google Sheet. Check sharing & tab names.</div>`;
        document.getElementById("statusText").innerHTML = "‚ùå Failed to connect to Google Sheets";
        document.getElementById("statusText").className = "status fail";
      }
    }
    init();
  </script>
</body>
</html>
