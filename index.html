<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pasta League ‚Äî Season 2025</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>üçù Pasta League ‚Äî Season 2025 üçù</h1>
  <p id="totalGoals">Total Goals: 0 ‚öΩ</p>

  <section>
    <h2>League Table</h2>
    <table id="leagueTable">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Player</th>
          <th>W</th>
          <th>D</th>
          <th>L</th>
          <th>GF</th>
          <th>GA</th>
          <th>Pts</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section>
    <h2>Top Scorers</h2>
    <div id="scorers">Loading...</div>
  </section>

  <section>
    <h2>Goal of the Week üé•</h2>
    <p>Upload coming soon...</p>
  </section>

  <div id="debug-box" style="color:yellow; font-size:12px;"></div>

  <script>
  async function loadLeagueData() {
    const sheetId = "üîπ◊î◊õ◊†◊° ◊õ◊ê◊ü ◊ê◊™ ◊î-ID ◊©◊ú ◊î◊í◊ô◊ú◊ô◊ï◊ü ◊©◊ú◊öüîπ";
    const sheetName = "LeagueTable";
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

    const tbody = document.querySelector("#leagueTable tbody");
    const debug = document.getElementById("debug-box");

    try {
      const res = await fetch(url);
      const text = await res.text();
      const json = JSON.parse(text.substr(47).slice(0, -2));
      const rows = json.table.rows;

      tbody.innerHTML = "";
      let totalGoals = 0;

      rows.forEach((r, i) => {
        const c = r.c.map(x => (x ? x.v : ""));
        const gf = parseInt(c[4] || 0);
        totalGoals += gf;

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${i + 1}</td>
          <td>${c[0]}</td>
          <td>${c[1]}</td>
          <td>${c[2]}</td>
          <td>${c[3]}</td>
          <td>${c[4]}</td>
          <td>${c[5]}</td>
          <td>${c[6]}</td>
        `;
        tbody.appendChild(tr);
      });

      document.getElementById("totalGoals").innerText = `Total Goals: ${totalGoals} ‚öΩ`;
      debug.innerText = "‚úÖ Connected to Google Sheets and loaded player names successfully!";
    } catch (err) {
      debug.innerText = "‚ùå Error loading data: " + err.message;
    }
  }

  loadLeagueData();
  </script>
</body>
</html>
